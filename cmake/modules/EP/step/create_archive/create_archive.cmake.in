
include("@CMUT_ROOT@/cmut.cmake")


file(GLOB files_and_directories
    LIST_DIRECTORIES true
    RELATIVE @package_install_dir@
    @package_install_dir@/*
    )

get_filename_component(archive_dir @archive_path@ DIRECTORY)

execute_process(
    COMMAND ${CMAKE_COMMAND} -E make_directory ${archive_dir}
    COMMAND ${CMAKE_COMMAND} -E tar Jcvf @archive_path@ ${files_and_directories}
    WORKING_DIRECTORY @package_install_dir@
    RESULT_VARIABLE result
    OUTPUT_VARIABLE output_var
    ERROR_VARIABLE error_var
    )

if(result)
    cmut_info("${function_name} failed.")
    cmut_info("command \"${command}\" return ${result}.")
    cmut_info(" output : ${output_var}")
    cmut_info(" error  : ${error_var}")
endif()
